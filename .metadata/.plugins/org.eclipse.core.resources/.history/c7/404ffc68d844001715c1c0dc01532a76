package graphics;
import javax.media.j3d.Transform3D;
import javax.vecmath.AxisAngle4d;
import javax.vecmath.Quat4d;
import javax.vecmath.Vector3d;

import com.sun.j3d.utils.universe.SimpleUniverse;

public class Camera 
{
	SimpleUniverse gameUniverse = null;
	Vector3d position = new Vector3d(0, 0, 0);
	Vector3d forward = new Vector3d(0, 0, 1);
	double rotationDegrees = 0.0;
	Transform3D rotationTransform = new Transform3D();
	Transform3D positionTransform = new Transform3D();
	
	public Camera()
	{
		
	}
	
	public Camera(SimpleUniverse universe)
	{
		gameUniverse = universe;
	}
	
	public void setUniverse(SimpleUniverse toSet)
	{
		gameUniverse = toSet;
	}
	
	public void SetPosition(Vector3d positionNew)
	{
		position = positionNew;
	}
	
	public void move(double x, double y, double z)
	{
		Quat4d quat = new Quat4d();
		rotationTransform.get(quat); 
		forward = new Vector3d(0, 0, 1);
		forward.cross(forward, new Vector3d(quat.getX(), quat.getY(), quat.getZ()));
		///rotationTransform.rotY(-rotationDegrees);
		//rotationTransform.transform(forward);
		position.x += x * forward.z;
		position.y += y * forward.y;
		position.z += z * forward.z;
		
	}
	
	public void SetRotation(double rotation)
	{
		rotationDegrees = rotation;
	}
	
	public void Update()
	{
		if(!gameUniverse.equals(null))
		{
			rotationTransform.rotY(-rotationDegrees);
			positionTransform.setTranslation(new Vector3d(position.x, position.y, position.z));
			Transform3D newTransform = positionTransform;
			newTransform.mul(rotationTransform);
			gameUniverse.getViewingPlatform().getViewPlatformTransform().setTransform(newTransform);
		}
	}
}
